<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">

 <head>

   {% load staticfiles %}
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script type="application/x-javascript"> addEventListener("load", function() { setTimeout(hideURLbar, 0); }, false);
		function hideURLbar(){ window.scrollTo(0,1); } </script>
  <!-- //for-mobile-apps -->
  <!-- js -->
  <script src="{% static 'assets/js/jquery-2.1.3.min.js' %}" type="text/javascript"></script>
  <!-- //js -->
  <link href="{% static 'assets/css/style.css' %}" rel="stylesheet" type="text/css" media="all" />
  <link href="{% static 'assets/css/fontsgooleapispopins.css' %}" rel="stylesheet" type="text/css" media="all" />
  <title>用户信息</title>
  <!-- Bootstrap Styles-->
  <link href="{% static 'assets/css/bootstrap.css' %}" rel="stylesheet" />
  <!-- FontAwesome Styles-->
  <link href="{% static 'assets/css/font-awesome.css' %}" rel="stylesheet" />
  <!-- Custom Styles-->
  <link href="{% static 'assets/css/custom-styles.css' %}" rel="stylesheet" />
  <!-- Google Fonts-->
	 <link href="{% static "btn_css/round_btn.css" %}" rel="stylesheet" />
 </head>

<body>
		<div id="wrapper">
				  {% include 'student/include/navtop.html' %} {% include 'student/include/navside.html' %}
				<div id="page-wrapper">
						<div id="page-inner">


								<div class="row">
										<div class="col-md-12">
												<h1 class="page-header">
														估分测试 <small><span id="username">Welcome, </span></small>
												</h1>
                                                <h2 class="page-header"><small>注意：开始估分后，我们将显示并记录您每道题估分所用时间。</small></h2>
                                                <h2 class="page-header"><small>选择试题：</small></h2>
										</div>
								</div>

                                <!--div class="row">
                                    <include clock declaration>
								</div-->
                                <div class="row" id = 'test_list'>
								</div>
				
			{% include 'student/include/footer.html' %}
						</div>
						<!-- /. PAGE INNER	-->
				</div>
				<!-- /. PAGE WRAPPER	-->
		</div>
		<!-- /. WRAPPER	-->
		<!-- JS Scripts-->
		<!-- jQuery Js -->
		<script src="{% static "js/jquery-3.1.1.min.js" %}"></script>
		<!-- Bootstrap Js -->
		<script src="{% static "js/bootstrap.min.js" %}"></script>
	 {% include 'student/include/jsinclude.html' %}
		<!-- Metis Menu Js -->
		<script src="{% static "js/jquery.metisMenu.js" %}"></script>

        <script>
		function getCookie(name) {
				var cookieValue = null;
				if (document.cookie && document.cookie !== '') {
						var cookies = document.cookie.split(';');
						for (var i = 0; i < cookies.length; i++) {
								var cookie = jQuery.trim(cookies[i]);
								// Does this cookie string begin with the name we want?
								if (cookie.substring(0, name.length + 1) === (name + '=')) {
										cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
										break;
								}
						}
				}
				return cookieValue;
		}
		function csrfSafeMethod(method) {
				// these HTTP methods do not require CSRF protection
				return (/^(GET|HEAD|OPTIONS|TRACE)$/.test(method));
		}
		</script>
		<!-- Custom Js -->
		<script>
			$(document).ready(function(){
				$('#username').append({{ id }});
				/*
				$.post("/backend/get_user_by_id", {'id': {{ id }} }, function(data, status, xhr){
					$('#username').append(data['username']);
				})
				*/
			});
			var user_array = [];
			function show_list(){
			    console.log('hehe');
				var tag1, tag2, tag3;
				var listitem = "";
				//user_array = [1,2,3];
				for(var i = 0; i < user_array.length; ++i){
					tag1 = String(i)+'_A';
					tag2 = String(i)+'_Aname';
					var tt_begin = "<div class=\"col-md-12\" style = \"width:100%\"><label id = \"" + tag2 + "\" style = \"font-size: 30px\">";
			        var data = user_array[i];
			        var tt_end = "</label><div class=\"button blue\" style = \"margin-right: auto;text-align:right;float:right\" id = \"" + tag1 + "\">开始测试</div></div>"
			        $('#test_list').append(tt_begin + data + tt_end);
					$('#'+tag1).click(function(){
					    var parse = this.id.split("_");
					    //alert(parse);
						var row = this.id + "name";
						//alert(row);
					    //alert(user_array);
					    //alert(i);
					    //alert(user_array[i]);
                        window.location="/student/do_test?test_name="+document.getElementById(row).innerHTML;
                        /*
					    $.post("/student/do_test/", {'test_name' : user_array[i]}, function(ret){
                            alert('hehe');
					    })
					    */
						//No need to examine the suffix since we are dealing with 'tag1'
			        })
			    }
			}
			$('#test_list').empty();
			//show_list();

			$.post("/student/get_all_tests/", {}, function(ret){
			    user_array = ret.tests;
			    //user_array = ['1','2','3'];
			    //alert(user_array);
				show_list();
			})

			var cur_sec = 0;
			var ff = function()
			{
			    //show_time(cur_sec);
			    cur_sec++;
			}
            //setInterval("ff()", 1000);
		</script>

</body>

</html>