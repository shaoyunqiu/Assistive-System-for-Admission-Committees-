<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
 <head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>用户信息</title>
 </head>
 <body>
   {% load staticfiles %}
  <!-- Bootstrap Styles-->
  <link href="{% static 'assets/css/bootstrap.css' %}" rel="stylesheet" />
  <!-- FontAwesome Styles-->
  <link href="{% static 'assets/css/font-awesome.css' %}" rel="stylesheet" />
  <!-- Custom Styles-->
  <link href="{% static 'assets/css/custom-styles.css' %}" rel="stylesheet" />
  <!-- Google Fonts-->
  <link href="http://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet" type="text/css" />
   <!-- profile-->
  <link href="{% static 'assets/css/profile/profile.css' %}" rel="stylesheet" type="text/css" />
  <div id="wrapper">
    {% include 'volunteer/include/navtop.html' %}
        <!--/. NAV TOP  -->
		{% include 'volunteer/include/navside.html' %}
        <!-- /. NAV SIDE  -->
   <div id="page-wrapper">
    <div id="page-inner">
     <!--row-->
     <div class="row">
      <div class="col-md-12">
       <div class="panel panel-default">
        <div class="panel-body">
         <div class="row">
          <div class="col-md-12">
           <form id = "form" action="#">
              {% csrf_token %}
            <h1>我的信息</h1>
            <div class="contentform">
             <div class="leftcontact">


              <div class="form-group">
               <p>姓名<span>*</span></p>
               <!--span class="icon-case"><i class="fa fa-male"></i></span>
               <input value="{{dict.realName}}" type="text" name="volunteer_name" id="volunteer_name" required data-rule="required" data-msg="V&eacute;rifiez votre saisie sur les champs : Le champ 'Nom' doit &ecirc;tre renseign&eacute;." /-->
               <input type="text" class="form-control" id="volunteer_name" name="realName" value="{{dict.volunteer_name}}" />
                  <div class="validation"></div>
              </div>

                 <div class="form-group">
               <p>性别<span>*</span></p>
               <select class="form-control" id="sex" name="sex">
                {% for item in dict.sex.sexlist %}
                   {% if forloop.counter0 == dict.sex.sex %}
                         <option value="{{forloop.counter0}}" selected="selected">{{item}}</option>
                   {% else %}
                         <option value="{{forloop.counter0}}">{{item}}</option>
                   {% endif %}
               {% empty %}
                   <li>抱歉，列表为空</li>
               {% endfor %}
               </select>
               <div class="validation"></div>
              </div>

                 <div class="form-group">
               <p>院系<span>*</span></p>
               <select class="form-control" id="department" name="department">
                {% for item in dict.department.departmentlist %}
                   {% if forloop.counter0 == dict.department.department %}
                         <option value="{{forloop.counter0}}" selected="selected">{{item}}</option>
                   {% else %}
                         <option value="{{forloop.counter0}}">{{item}}</option>
                   {% endif %}
               {% empty %}
                   <li>抱歉，列表为空</li>
               {% endfor %}
               </select>
               <div class="validation"></div>
              </div>

                 <div class="form-group">
               <p>班级<span>*</span></p>
               <!--span class="icon-case"><i class="fa fa-male"></i></span>
               <input value="{{dict.email}}" type="text" name="email" id="email" required data-rule="required" data-msg="V&eacute;rifiez votre saisie sur les champs : Le champ 'Nom' doit &ecirc;tre renseign&eacute;." /-->
               <input type="text" class="form-control" id="classroom" name="classroom" value="{{dict.classroom}}" />
                      <div class="validation"></div>
              </div>

                 <div class="form-group">
               <p>学号<span>*</span></p>
               <!--span class="icon-case"><i class="fa fa-male"></i></span>
               <input value="{{dict.email}}" type="text" name="email" id="email" required data-rule="required" data-msg="V&eacute;rifiez votre saisie sur les champs : Le champ 'Nom' doit &ecirc;tre renseign&eacute;." /-->
               <input type="text" class="form-control" id="studentID" name="studentID" value="{{dict.studentID}}" />
                      <div class="validation"></div>
              </div>


                 <div class="form-group">
               <p>修改密码</p>
               <!--span class="icon-case"><i class="fa fa-comments-o"></i></span-->
               <input type="password" class="form-control" id="password" name="password" value="" />
               <div class="validation"></div>
              </div>

                <div class="form-group">
               <p>确认修改密码</p>
               <!--span class="icon-case"><i class="fa fa-comments-o"></i></span-->
               <input type="password" class="form-control" id="confirm_password" name="confirm_password" value="" />
               <div class="validation"></div>
              </div>

                </div>


                <div class="rightcontact">
                <div class="form-group">
               <p>手机<span>*</span></p>
               <!--span class="icon-case"><i class="fa fa-male"></i></span>
               <input value="{{dict.phone}}" type="text" name="phone" id="phone" required data-rule="required" data-msg="V&eacute;rifiez votre saisie sur les champs : Le champ 'Nom' doit &ecirc;tre renseign&eacute;." /-->
               <input type="text" class="form-control" id="phone" name="phone" value="{{dict.phone}}" />
                     <div class="validation"></div>
              </div>

                 <div class="form-group">
               <p>民族<span>*</span></p>
               <select class="form-control" id="nation" name="nation">
                {% for item in dict.nation.nationlist %}
                   {% if forloop.counter0 == dict.nation.nation %}
                         <option value="{{forloop.counter0}}" selected="selected">{{item}}</option>
                   {% else %}
                         <option value="{{forloop.counter0}}">{{item}}</option>
                   {% endif %}
               {% empty %}
                   <li>抱歉，列表为空</li>
               {% endfor %}
               </select>
               <div class="validation"></div>
              </div>

                   <div class="form-group">

               <p>生源地<span>*</span></p>
             <select class="form-control" id="province" name="province">
                {% for item in dict.province.provincelist %}
                   {% if forloop.counter0 == dict.province.province %}
                         <option value="{{forloop.counter0}}" selected="selected">{{item}}</option>
                   {% else %}
                         <option value="{{forloop.counter0}}">{{item}}</option>
                   {% endif %}
               {% empty %}
                   <li>抱歉，列表为空</li>
               {% endfor %}
               </select>
            <div class="validation"></div>
                       </div>

                    <div class="form-group">
               <p>E-mail<span>*</span></p>
               <!--span class="icon-case"><i class="fa fa-male"></i></span>
               <input value="{{dict.email}}" type="text" name="email" id="email" required data-rule="required" data-msg="V&eacute;rifiez votre saisie sur les champs : Le champ 'Nom' doit &ecirc;tre renseign&eacute;." /-->
               <input type="text" class="form-control" id="email" name="email" value="{{dict.email}}" />
                      <div class="validation"></div>
                        </div>

                    <div class="form-group">
               <p>QQ</p>
               <!--span class="icon-case"><i class="fa fa-male"></i></span-->
               <!--input value="{{dict.qqn}}" type="text" name="qqn" id="qqn" required data-rule="required" data-msg="V&eacute;rifiez votre saisie sur les champs : Le champ 'Nom' doit &ecirc;tre renseign&eacute;." /-->
                <input type="text" class="form-control" id="qqn" name="qqn" value="{{dict.qqn}}" />
                     <div class="validation"></div>
              </div>

              <div class="form-group">
               <p>微信</p>
               <!--span class="icon-case"><i class="fa fa-comments-o"></i></span-->
               <input type="text" class="form-control" id="weichat" name="weichat" value="{{dict.weichat}}" />
               <div class="validation"></div>
              </div>



             </div>

                <!--fieldset disabled=""-->
                <div class="form-group">
               <p>分管组</p>
               <!--span class="icon-case"><i class="fa fa-comments-o"></i></span-->
               <input type="text" class="form-control" id="distribute" name="distribute" value="{{dict.distribute}}" readonly="true"/>
               <div class="validation"></div>
              </div><!--fieldset/-->

                <div class="form-group">
               <p>历史个人工作日志<span></span></p>
               <!--span class="icon-case"><i class="fa fa-comments-o"></i></span-->
                <textarea type="text" class="form-control" id="describe" name="describe" rows="4" disabled = "disabled">{{dict.describe}}</textarea>
               <div class="validation"></div>
            </div>

                <div class="form-group">
               <p>添加个人工作日志<span></span></p>
               <!--span class="icon-case"><i class="fa fa-comments-o"></i></span-->
                <textarea type="text" class="form-control" id="describe_add" name="describe" rows="4"></textarea>
               <div class="validation"></div>
            </div></div>
            <button type="submit" id="volunteer_save" name="volunteer_save" class="bouton-contact">保存（若填写了添加个人工作日志栏，将上传一次工作日志）</button>
           </form>
          </div>
         </div>
        </div>
       </div>
      </div>
     </div>
          {% include 'teacher/include/footer.html' %}
    </div>
    <!-- /. PAGE INNER  -->
   </div>
   <!-- /. PAGE WRAPPER  -->
  </div>
  <!-- /. WRAPPER  -->
  <!-- JS Scripts-->
  <!-- jQuery Js -->
  <script src="{% static 'assets/js/jquery-1.10.2.js' %}"></script>
  <!-- Bootstrap Js -->
  <script src="{% static 'assets/js/bootstrap.min.js' %}"></script>
  <!-- Metis Menu Js -->
  <script src="{% static 'assets/js/jquery.metisMenu.js' %}"></script>
  <!-- Morris Chart Js -->
  <script src="{% static 'assets/js/morris/raphael-2.1.0.min.js' %}"></script>
  <!--<script src="{% static 'assets/js/morris/morris.js' %}"></script>-->
  <script src="{% static 'assets/js/easypiechart.js' %}"></script>
  <script src="{% static 'assets/js/easypiechart-data.js' %}"></script>
  <!-- Custom Js -->
  <script src="{% static 'assets/js/custom-scripts.js' %}"></script>
   <script>
   {% if dict.auth == "0" %}
        alert('对不起，您没有浏览该内容的权限，将回到个人信息界面');
   {% endif %}
    </script>
     <script src="{% static 'jquery-validation-1.14.0/dist/jquery.validate.min.js' %}"></script>
  <script src="{% static 'jquery-validation-1.14.0/dist/additional-methods.js' %}"></script>
  <script src="{% static 'jquery-validation-1.14.0/dist/localization/messages_zh.js' %}"></script>
    <script>
      var save1 = function (){
        var volunteer_name = $("#volunteer_name").val();
        var sex = $("#sex").val();
        var department = $("#department").val();
        var classroom = $("#classroom").val();
        var email = $("#email").val();
        var phone = $("#phone").val();
        var nation = $("#nation").val();
        var province = $("#province").val();
        var studentID = $("#studentID").val();
        var password = $("#password").val();
        var confirm_password = $("#confirm_password").val();
        var qqn = $("#qqn").val();
        var weichat = $("#weichat").val();
        var distribute = $("#distribute").val();
        var describe = $("#describe_add").val();
        var myDate = new Date();
        if(describe.length > 0)
        {
            describe = '[' + myDate.toLocaleString() + '] ' + describe;
        }
        $.post("",
            {
                'volunteer_name':volunteer_name,
                'sex':sex,
                'department':department,
                'classroom':classroom,
                'email':email,
                'phone':phone,
                'nation':nation,
                'province':province,
                'qqn':qqn,
                'weichat':weichat,
                'distribute':distribute,
                'describe':describe,
                'studentID':studentID,
                'password':password
            },
            function(profileDict){
                if(profileDict['success'].charAt(0)=='N'){
                    //$.growl.error({ title: "修改信息失败", message: ret['message'] });
                    alert('修改失败，请重试');
                }
                else
                {
                    //$.growl.error({ title: "修改信息成功", message: ret['message'] });
                    alert('修改成功');
                }
                window.location="/volunteer/profile";
        });
      };
      $(document).ready(function(){
        $('#profile').attr("href", "#");
        $("#form").validate({
          submitHandler:save1,
          debug:false,
          rules:{
            volunteer_name:{
              required:true
            },
            sex:{
              min:1
            },
            department:{
              min:1
            },
            classroom:{
              required:true
            },
            email:{
              email:true,
              required:true
            },
            phone:{
              required:true,
              minlength:11,
              maxlength:11,
              digits:true
            },
            nation:{
              min:1
            },
            province:{
              min:1
            },
            weichat:{
              required:true
            },
            qqn:{
              digits:true,
              required:true
            },
            studentID:{
              digits:true,
              required:true
            },
            password:{
              legalPassword: true
            },
            confirm_password:{
              equalTo:'#password'
            }
          },
          messages:{
            phone:{
              minlength:"<span>请输入有效的手机号码</span>",
              maxlength:"<span>请输入有效的手机号码</span>",
              digits:"<span>请输入有效的手机号码</span>",
            },
            sex:{
              min:"<span>请选择一个选项</span>",
            },
            department:{
              min:"<span>请选择一个选项</span>",
            },
            nation:{
              min:"<span>请选择一个选项</span>",
            },
            province:{
              min:"<span>请选择一个选项</span>",
            }
          }
        });
      });
  </script>
 </body>
</html>
